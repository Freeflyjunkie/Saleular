@{
    ViewBag.Title = "Ship It";
}
<script src="~/Scripts/jquery/jquery.validate.min.js"></script>
@*<script src="~/Scripts/jquery/jquery.validate.unobtrusive.min.js"></script>*@
<script>
    $(document).ready(function () {

        SetTooltip($('#nameAddon'));
        SetTooltip($('#emailAddon'));
        SetTooltip($('#addressAddon'));
        SetTooltip($('#cityAddon'));
        SetTooltip($('#stateAddon'));
        SetTooltip($('#zipAddon'));

        $('input[name=zip]').on('blur', function () {
            var url = 'http://zip.elevenbasetwo.com/v2/US/' + $(this).val();
            $.ajax({
                url: url,
                type: 'GET',
                dataType: 'json',
                success: function (data, status, xhr) {
                    $('input[name=state]').val(data["state"]);
                    $('input[name=city]').val(data["city"]);
                    $("#shipForm").submit();
                }
            });
        });


        $.validator.addMethod("NumbersOnly", function (value, element) {
            return this.optional(element) || /^[0-9\-\+]+$/i.test(value);
        }, "Phone must contain only numbers, + and -.");


        $("#shipForm").validate({
            rules: {
                zip: "required NumbersOnly",
                name: {
                    required: true,
                    minlength: 2
                },
                address: {
                    required: true,
                },
                city: {
                    required: true,
                },
                state: {
                    required: true,
                    minlength: 2
                },
                email: {
                    required: true,
                    email: true
                }
            },
            messages: {
                name: {
                    required: "Your name is required",
                    minlength: "Your name must be at least {0} characters"
                },
                address: {
                    required: "Your address is required"
                },
                zip: {
                    required: "Your zip is required"
                },
                city: {
                    required: "Your city is required"
                },
                state: {
                    required: "Your state is required",
                    minlength: "Your state must be at least {0} characters"
                },
                email: {
                    required: "Your email is required"
                }
            },
            errorPlacement: function (error, element) {
                $(element).parent("div").parent("div").parent("div").children('.validation-error').html(error.html());
            },
            success: function (label) {
                //$(label).parent("div").parent("div").parent("div").children('.validation-error').html('ok');
            },
            highlight: function (element, errorClass, validClass) {               
                var field = $(element.form).find("input[name=" + element.id + "]");
                field.css('border', '1px solid red');
            },
            unhighlight: function (element, errorClass, validClass) {
                var field = $(element.form).find("input[name=" + element.id + "]");
                field.css('border', 'none');                
            }
        });
    });

    function SetTooltip(addon) {
        addon.tooltip();
        addon.css('cursor', 'pointer');
    }
</script>
<style>
    .form-horizontal .control-label {
        text-align: left;
    }

    .validation-error {
        color: red;
        padding-top: 10px;
    }
</style>
<div class="col-lg-12 col-md-12">
    <h2>Now Ship It</h2>
    <p>
        Request a free shipping label and ship your phone quickly and easily using Fedex or the USPS.
    </p>
    <hr />
</div>
<div class="col-lg-12 col-md-12">
    <form id="shipForm" class="form-horizontal" method="post">
        <div class="form-group">
            <label for="name" class="control-label col-lg-1 col-md-1">Name</label>
            <div class="col-md-6">
                <div class="input-group">
                    <span id="nameAddon" data-toggle="tooltip" title="Tell us who you are!" class="input-group-addon box-shadow-dgray"><span class="glyphicon glyphicon-user"></span></span>
                    <input id="name"
                           type="text"
                           name="name"
                           tabindex="1"
                           class="form-control box-shadow-dgray"
                           placeholder="e.g. Brad Pitt" />

                </div>
            </div>
            <div class="col-md-2 control-label validation-error">
            </div>
        </div>
        <div class="form-group">
            <label for="address" class="control-label col-lg-1 col-md-1">Address</label>
            <div class="col-md-6">
                <div class="input-group">
                    <span id="addressAddon" data-toggle="tooltip" title="What street do you live on?" class="input-group-addon box-shadow-dgray"><span class="glyphicon glyphicon-user"></span></span>
                    <input id="address"
                           type="text"
                           name="address"
                           tabindex="2"
                           class="form-control box-shadow-dgray"
                           placeholder="e.g. 123 Main Street" />
                </div>
            </div>
            <div class="col-md-2 control-label validation-error">
            </div>
        </div>
        <div class="form-group">
            <label for="zip" class="control-label col-lg-1 col-md-1">Zip</label>
            <div class="col-md-6">
                <div class="input-group">
                    <span id="zipAddon" data-toggle="tooltip" title="What zipcode do you live in?" class="input-group-addon box-shadow-dgray"><span class="glyphicon glyphicon-user"></span></span>
                    <input id="zip"
                           type="text"
                           name="zip"
                           tabindex="3"
                           class="form-control box-shadow-dgray"
                           placeholder="e.g. 12345" />
                </div>
            </div>
            <div class="col-md-2 control-label validation-error">
            </div>
        </div>
        <div class="form-group">
            <label for="city" class="control-label col-lg-1 col-md-1">City</label>
            <div class="col-md-6">
                <div class="input-group">
                    <span id="cityAddon" data-toggle="tooltip" title="What city do you live in?" class="input-group-addon box-shadow-dgray"><span class="glyphicon glyphicon-user"></span></span>
                    <input id="city"
                           type="text"
                           name="city"
                           tabindex="-1"
                           class="form-control box-shadow-dgray"
                           placeholder="e.g. Anytown" />
                </div>
            </div>
            <div class="col-md-2 control-label validation-error">
            </div>
        </div>
        <div class="form-group">
            <label for="state" class="control-label col-lg-1 col-md-1">State</label>
            <div class="col-md-6">
                <div class="input-group">
                    <span id="stateAddon" data-toggle="tooltip" title="What state do you live in?" class="input-group-addon box-shadow-dgray"><span class="glyphicon glyphicon-user"></span></span>
                    <input id="state"
                           type="text"
                           name="state"
                           tabindex="-1"
                           class="form-control box-shadow-dgray"
                           placeholder="e.g. Anystate" />
                </div>
            </div>
            <div class="col-md-2 control-label validation-error">
            </div>
        </div>
        <div class="form-group">
            <label for="email" class="control-label col-lg-1 col-md-1">Email</label>
            <div class="col-md-6">
                <div class="input-group">
                    <span id="emailAddon" data-toggle="tooltip" title="This email address will be used for later correspondence" class="input-group-addon box-shadow-dgray">&#64;</span>
                    <input id="email"
                           type="email"
                           name="email"
                           tabindex="4"
                           class="form-control box-shadow-dgray"
                           placeholder="e.g. bpitt@gmail.com" />
                </div>
            </div>
            <div class="col-md-2 control-label validation-error">
            </div>
        </div>
        <div class="form-group">
            <label for="comments" class="control-label col-lg-1 col-md-1">Comments</label>
            <div class="col-md-6">
                <textarea name="comments"
                          rows="6"
                          cols="40"
                          tabindex="5"
                          class="form-control box-shadow-dgray"
                          placeholder="e.g. Send me my shipping label!"></textarea>

            </div>
            <div class="col-md-2 validation-error">
            </div>
        </div>
        <div class="form-group">
            <div class="col-lg-11 col-md-11 col-lg-offset-1 col-md-offset-1">
                <input type="submit" class="btn btn-primary" value="Request Shipping Label" />
            </div>
        </div>
    </form>
</div>